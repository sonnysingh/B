

*** Remove Data amd Log files of DBs CxActivity & CxDB in NEXT WEEK on  SAKLDMSQLP04****


\\saueazfsq01\bnz-datamanagement-team\Source
\\bnznag.nz.thenational.com\dfslocation\ApplicationSource\DataManagement\DBAShare
Azure - \\SAUEAZFSP01\bnz-tas-team
OnPremise - \\SORBAZFSP01\bnz-tas-team

In Azure check if you can access \\SAUEAZFSQ01\bnz-dotnet-team, if you can then copy the back up there. Then on premise you can get the backup from \\SETTAZFSQ01\bnz-dotnet-team

## You could try below for Non-Prod 
On-Premise SMB Path: \\SETTAZFSQ01\bnz-dotnet-team
Azure SMB Path: \\SAUEAZFSQ01\bnz-dotnet-team

C-Admin Account - A_Azure_PreProd_FileSync - bnz-dotnet-team -C
Regular Account - A_Azure_PreProd_FileSync - bnz-dotnet-team -S
	
You will need to request A_Azure_PreProd_FileSync - bnz-dotnet-team -S

"C:\Program Files\Veeam\Plugins\Microsoft SQL\MSSQLRecoveryManager.exe" --backup  --type=full  --d="FinHub" --parallelism=1 --name="VEEAM_FULL_BACKUP_FinHUB" --description="VEEAM_FULL_BACKUP_FinHUB" --retention=7 --use_compression --check_preferred

On call number (04) 924 9350

Letmein@C01

- MS SQL DBA team meetup - .5 hr
	- discuss Azure SQL seerver access thru Azure Jump Box access denied
	- email removing Jira task of Dan Park
	- discuss access of SAUESTDBP01
	- Discuss Change Task
	- Discuss some 

- ODS - Stand up - .5 hr

- Clean up some Jira Tickets (cards) - SLA Breach
- Review Jira Cards and SNOW board for INc/REQs/Change Tasks
- Review Chnage Tasks and asked Eduard on TEams to whoch ne i fesible to pick up.

- INC007026655 (The ServiceNow Discovery credentials for SQL discovery (srvprodsnowdissql, srvdevsnowdissql) stopped working last September 17 when the password was rotated. Could you please help check if the credentials are still valid? ) - 1.5  hrs *** yesterday spen 2 hrs and discussed with Erica and David about ownership. Discuss with requester about requirements.


- INC007021223 ( myAccess unable to connect to database - The transaction log for database 'identityiq' is full due to 'LOG_BACKUP' ) - saklsqlsptp01

- INC007019627 (APEX - Unable to connect to database. Connection failes when trying to connect to the database (DBAPP-APEX)) - 
	- 
- INC007021223 ( myAccess unable to connect to database - The transaction log for database 'identityiq' is full due to 'LOG_BACKUP') - SAKLSQLSPTP01\SQL2017
	- Investigation issue on the server and review Logs and no sign of 'LOG_BACKUP' issue. Monitoring conducted. Log space no more than 2% 

- INC007033847 - ( sakldmsqlp21:Drive D: has 10% space left ) - Drive running with 163 GB of free space . No issue found

- https://jira.nz.thenational.com/browse/DASD-3105 - query run successfully and output attached as excel sheet.

- https://jira.nz.thenational.com/browse/DASD-2838 - Had meeting with Jag Singh on Thursday and he confirmed to close it.

- https://jira.nz.thenational.com/browse/DASD-3108 - Query executing successfully and result attached.

















- https://jira.nz.thenational.com/browse/DASD-3094 - 
The Treasury team have an Excel Reconciliation spreadsheet which was used to connect directly to the ABS Database, however that access was removed during the ABS Plus project implementation. This has necessitated additional manual business processes for their reconciliation.
I am now looking at alternative options, with one of those being to re-connect Excel to the DB, while enabling additional DB security features (to address addressing security concerns), so my questions are the following:
Could we enable SQL Server audit logging on for this DB?
And if so, can this be enabled for this user / connection only? 
This would be to minimise the performance impact to the ABS/Travis apps.
Could we enable Forced Encryption in Transit for the DB connection?
Likewise, can this be enabled for this user / connection only?
Again to minimise the performance impact.
Alternatively, do we know if the connection is already encrypted? 
As my security advisor (Oliver Lineham) suggested this may already be the case (potentially TLS?)
The DBs in question are shown in the attached screenshot.



SELECT 
    s.session_id,
    s.login_name,
    s.program_name,
    s.host_name,
    c.encrypt_option AS Is_Encrypted,
    c.client_net_address AS IP_Address,
    CASE c.encrypt_option
        WHEN 'TRUE' THEN NCHAR(10003) + '  Using certificate/TLS'
        ELSE  NCHAR(10007) + '  Not encrypted (certificate available but not used)'
    END AS Encryption_Status
FROM sys.dm_exec_connections c
INNER JOIN sys.dm_exec_sessions s ON c.session_id = s.session_id
WHERE s.is_user_process = 1
ORDER BY c.encrypt_option DESC, s.program_name;



EXEC sp_readerrorlog 0, 1, N'encryption' - SWVPABSSQL01
LogDate----------------|----ProcessInfo-------| Text
2025-09-28 07:03:12.400		spid27s			  The certificate [Cert Hash(sha1) "A2CD79AB05759C9B028186003337A21E2A66011D"] was successfully loaded for encryption.


EXEC sp_readerrorlog 0, 1, N'encryption'; - SWVPABSSQL02
LogDate	ProcessInfo	Text
2025-09-28 18:39:29.730	spid26s	The certificate [Cert Hash(sha1) "B99C3D6653A0F708B03DCBD5E60E7D90BCA9CD7C"] was successfully loaded for encryption.

EXEC sp_readerrorlog 0, 1, N'encryption'; - SWVPABSSQL51
LogDate	ProcessInfo	Text
2025-09-28 07:26:17.610	spid28s	The certificate [Cert Hash(sha1) "ECBD52FE0AB63F06A479DF207A1203A8FBAD4FF7"] was successfully loaded for encryption.


EXEC sp_readerrorlog 0, 1, N'encryption' - SWVPABSSQL52
LogDate	ProcessInfo	Text
2025-09-28 18:51:01.300	spid27s	The certificate [Cert Hash(sha1) "2A298293EB70A056D5872002AC42F67413E94B42"] was successfully loaded for encryption.

EXEC sp_readerrorlog 0, 1, N'encryption' - SWVDABSSQL01
LogDate	ProcessInfo	Text
2025-09-21 05:31:03.990	spid23s	The certificate [Cert Hash(sha1) "4CC15A9B08BB5B315FE7FD8403461374159034CA"] was successfully loaded for encryption.

EXEC sp_readerrorlog 0, 1, N'encryption' - SWVTABSSQL01
LogDate	ProcessInfo	Text
2025-09-21 05:31:01.640	spid22s	The certificate [Cert Hash(sha1) "B3FC9F37E237442D2FCCDE65B5938B92D0F65AEF"] was successfully loaded for encryption.




select @@VERSION

SELECT serverproperty('ProductVersion') as Version,
serverproperty('ProductLevel') as ServiePack,
serverproperty('ProductUpdateLevel') as CU_Level,
serverproperty('Edition') as Edition

EXEC xp_instance_regread 
    N'HKEY_LOCAL_MACHINE', 
    N'SOFTWARE\Microsoft\MSSQLServer\MSSQLServer\SuperSocketNetLib', 
    N'ForceEncryption';



- 

- 






